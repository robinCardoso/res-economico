# ๐ Diagramas e Fluxos - Sistema de 3 Linhas de Atas

## ๐ Fluxo Geral do Sistema

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    SISTEMA DE ATAS                              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                              โ
                              โผ
        โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
        โ   /admin/atas/importar             โ
        โ   Upload de PDF/TXT                โ
        โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                              โ
                โโโโโโโโโโโโโโโผโโโโโโโโโโโโโโ
                โผ             โผ             โผ
        โโโโโโโโโโโโโ  โโโโโโโโโโโโโ  โโโโโโโโโโโโโ
        โ RASCUNHO  โ  โEM PROCESSOโ  โFINALIZADA โ
        โโโโโโโโโโโโโ  โโโโโโโโโโโโโ  โโโโโโโโโโโโโ
                โ             โ             โ
                โผ             โผ             โผ
        โโโโโโโโโโโโโ  โโโโโโโโโโโโโ  โโโโโโโโโโโโโ
        โ   IA      โ  โ Histรณrico โ  โ Consulta  โ
        โ Transcriรงรฃoโ  โ  Prazos  โ  โ Exportaรงรฃoโ
        โโโโโโโโโโโโโ  โโโโโโโโโโโโโ  โโโโโโโโโโโโโ
```

---

## ๐ Fluxo: RASCUNHO

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ 1. USUรRIO FAZ UPLOAD                                        โ
โ    - Seleciona arquivo PDF                                  โ
โ    - Escolhe tipo "Rascunho"                                 โ
โ    - Seleciona tipo de reuniรฃo                              โ
โ    - (Opcional) Seleciona modelo de ata                      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                              โ
                              โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ 2. SISTEMA EXTRAI TEXTO                                      โ
โ    - Gemini Vision API processa PDF                         โ
โ    - Extrai todo o texto do documento                       โ
โ    - Retorna texto estruturado                               โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                              โ
                              โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ 3. IA TRANSCREVE                                            โ
โ    - Busca modelo de ata (se fornecido)                     โ
โ    - Cria prompt com texto + modelo                         โ
โ    - Gemini gera transcriรงรฃo profissional                   โ
โ    - Extrai tรณpicos importantes                             โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                              โ
                              โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ 4. USUรRIO REVISA                                           โ
โ    - Visualiza texto extraรญdo                               โ
โ    - Visualiza transcriรงรฃo sugerida                         โ
โ    - Visualiza tรณpicos importantes                          โ
โ    - Edita transcriรงรฃo manualmente                          โ
โ    - Pode usar outro modelo para re-transcrever             โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                              โ
                โโโโโโโโโโโโโโโผโโโโโโโโโโโโโโ
                โผ             โผ             โผ
        โโโโโโโโโโโโโ  โโโโโโโโโโโโโ  โโโโโโโโโโโโโ
        โ  SALVAR   โ  โ FINALIZAR โ  โ  MOVER    โ
        โ RASCUNHO  โ  โTRANSCRIรรOโ  โEM PROCESSOโ
        โโโโโโโโโโโโโ  โโโโโโโโโโโโโ  โโโโโโโโโโโโโ
```

---

## โ๏ธ Fluxo: EM PROCESSO

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ 1. ATA EM PROCESSO                                          โ
โ    - Status: EM_PROCESSO                                    โ
โ    - Ata jรก transcrita e revisada                           โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                              โ
                โโโโโโโโโโโโโโโผโโโโโโโโโโโโโโ
                โผ             โผ             โผ
        โโโโโโโโโโโโโ  โโโโโโโโโโโโโ  โโโโโโโโโโโโโ
        โ HISTรRICO โ  โ  PRAZOS    โ  โ  STATUS    โ
        โโโโโโโโโโโโโ  โโโโโโโโโโโโโ  โโโโโโโโโโโโโ
                โ             โ             โ
                โผ             โผ             โผ
        โโโโโโโโโโโโโ  โโโโโโโโโโโโโ  โโโโโโโโโโโโโ
        โ Adicionar โ  โ Criar     โ  โ Assinaturaโ
        โ Aรงรฃo      โ  โ Prazo     โ  โ Registro  โ
        โโโโโโโโโโโโโ  โโโโโโโโโโโโโ  โโโโโโโโโโโโโ
                              โ
                              โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ 2. SISTEMA DE LEMBRETES                                     โ
โ    - Verifica prazos diariamente                            โ
โ    - 3 dias antes: Lembrete preventivo                      โ
โ    - 1 dia antes: Lembrete urgente                          โ
โ    - No dia: Lembrete final                                 โ
โ    - Apรณs vencimento: Lembrete diรกrio                       โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                              โ
                              โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ 3. NOTIFICAรรES                                             โ
โ    - Notificaรงรฃo no sistema                                 โ
โ    - Email (se configurado)                                 โ
โ    - Badge no menu                                          โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                              โ
                              โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ 4. CONCLUSรO                                                โ
โ    - Todos os prazos concluรญdos                            โ
โ    - Assinatura realizada                                   โ
โ    - Registro em cartรณrio                                  โ
โ    - Mudar status para FINALIZADA                           โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## โ Fluxo: FINALIZADA

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ 1. IMPORTAR ATA FINALIZADA                                  โ
โ    - Upload de PDF/TXT                                      โ
โ    - Tipo: "Finalizada"                                      โ
โ    - Preencher dados bรกsicos                                โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                              โ
                              โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ 2. DADOS DE REGISTRO (Opcional)                             โ
โ    - Data de registro                                       โ
โ    - Cartรณrio                                               โ
โ    - Nรบmero de registro                                     โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                              โ
                              โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ 3. ARMAZENAMENTO                                            โ
โ    - Status: FINALIZADA                                     โ
โ    - Disponรญvel para consulta                               โ
โ    - Pode ser exportada                                     โ
โ    - Pode ser arquivada                                     โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ๐๏ธ Estrutura do Banco de Dados

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    AtaReuniao                                โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ id, numero, titulo, tipo, dataReuniao                       โ
โ status (RASCUNHO|EM_PROCESSO|FINALIZADA)                     โ
โ dataAssinatura, dataRegistro, cartorioRegistro              โ
โ pautas (JSON), decisoes (JSON), acoes (JSON)                โ
โ geradoPorIa, iaUsada, modeloIa                             โ
โ arquivoOriginalUrl, arquivoOriginalNome                     โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
         โ              โ              โ              โ
         โ              โ              โ              โ
         โผ              โผ              โผ              โผ
โโโโโโโโโโโโโโโ โโโโโโโโโโโโโโโ โโโโโโโโโโโโโโโ โโโโโโโโโโโโโโโ
โ ModeloAta   โ โ Historico    โ โ PrazoAcao   โ โ Lembrete    โ
โ             โ โ Andamento    โ โ             โ โ Prazo       โ
โโโโโโโโโโโโโโโค โโโโโโโโโโโโโโโค โโโโโโโโโโโโโโโค โโโโโโโโโโโโโโโค
โ id          โ โ id          โ โ id          โ โ id          โ
โ nome        โ โ ataId       โ โ ataId       โ โ prazoId     โ
โ tipoReuniao โ โ data        โ โ titulo      โ โ usuarioId   โ
โ estrutura   โ โ acao        โ โ dataPrazo   โ โ tipo        โ
โ exemplo     โ โ descricao   โ โ status      โ โ mensagem    โ
โ instrucoes  โ โ responsavel โ โ concluido   โ โ enviado     โ
โโโโโโโโโโโโโโโ โโโโโโโโโโโโโโโ โโโโโโโโโโโโโโโ โโโโโโโโโโโโโโโ
```

---

## ๐ค Fluxo de IA - Transcriรงรฃo

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    PDF Upload                                โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                              โ
                              โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ          Gemini Vision API                                   โ
โ    - Processa PDF escaneado                                  โ
โ    - Extrai texto completo                                  โ
โ    - Retorna texto estruturado                               โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                              โ
                              โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ          Buscar Modelo de Ata                               โ
โ    - Por tipo de reuniรฃo                                    โ
โ    - Ou modelo especรญfico fornecido                         โ
โ    - Retorna estrutura e instruรงรตes                         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                              โ
                              โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ          Criar Prompt                                       โ
โ    - Texto extraรญdo                                         โ
โ    - Estrutura do modelo                                    โ
โ    - Instruรงรตes do modelo                                   โ
โ    - Tipo de reuniรฃo                                        โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                              โ
                              โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ          Gemini Generate Content                            โ
โ    - Modelo: gemini-pro                                     โ
โ    - Temperature: 0.7                                        โ
โ    - Max tokens: 4000                                       โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                              โ
                              โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ          Processar Resposta                                 โ
โ    - Parse JSON                                             โ
โ    - Estruturar dados                                       โ
โ    - Validar campos                                         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                              โ
                              โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ          Extrair Tรณpicos Importantes                       โ
โ    - Chamada adicional ao Gemini                            โ
โ    - Identifica pontos-chave                                โ
โ    - Classifica por importรขncia                             โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                              โ
                              โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ          Retornar para Usuรกrio                             โ
โ    - Transcriรงรฃo completa                                   โ
โ    - Tรณpicos importantes                                    โ
โ    - Dados estruturados                                     โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## โฐ Sistema de Lembretes - Fluxo Diรกrio

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ          CRON JOB (Todo dia รs 9h)                          โ
โ    @Cron('0 9 * * *')                                       โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                              โ
                              โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ          Verificar Prazos                                  โ
โ    - Prazos vencidos (dataPrazo < hoje)                    โ
โ    - Prazos prรณximos (3 dias antes)                         โ
โ    - Prazos urgentes (1 dia antes)                          โ
โ    - Prazos de hoje                                         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                              โ
                              โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ          Para cada Prazo                                    โ
โ    - Verificar se jรก foi enviado lembrete                  โ
โ    - Verificar frequรชncia de lembretes                      โ
โ    - Criar lembrete se necessรกrio                           โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                              โ
                โโโโโโโโโโโโโโโผโโโโโโโโโโโโโโ
                โผ             โผ             โผ
        โโโโโโโโโโโโโ  โโโโโโโโโโโโโ  โโโโโโโโโโโโโ
        โ NOTIFICAรรOโ  โ   EMAIL   โ  โ   AMBOS   โ
        โ  SISTEMA   โ  โ           โ  โ           โ
        โโโโโโโโโโโโโ  โโโโโโโโโโโโโ  โโโโโโโโโโโโโ
                โ             โ             โ
                โโโโโโโโโโโโโโโผโโโโโโโโโโโโโโ
                              โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ          Registrar Envio                                    โ
โ    - Atualizar LembretePrazo                               โ
โ    - Marcar como enviado                                    โ
โ    - Registrar data de envio                               โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ๐ Checklist de Implementaรงรฃo

### Fase 1: Estrutura Base
```
[ ] Atualizar enum StatusAta no schema
[ ] Criar modelo ModeloAta
[ ] Criar modelo HistoricoAndamento
[ ] Criar modelo PrazoAcao
[ ] Criar modelo LembretePrazo
[ ] Atualizar modelo AtaReuniao
[ ] Criar migrations
[ ] Executar migrations
[ ] Atualizar DTOs bรกsicos
```

### Fase 2: Backend - Rascunhos
```
[ ] Implementar extraรงรฃo de texto PDF (Gemini)
[ ] Criar ModeloAtaService
[ ] Implementar transcriรงรฃo com IA
[ ] Implementar extraรงรฃo de tรณpicos
[ ] Criar endpoint importar/rascunho
[ ] Criar endpoint modelos-ata
[ ] Testes unitรกrios
```

### Fase 3: Backend - Em Processo
```
[ ] Criar HistoricoAndamentoService
[ ] Criar PrazoAcaoService
[ ] Implementar verificaรงรฃo de prazos
[ ] Implementar sistema de lembretes
[ ] Criar job agendado (Cron)
[ ] Criar endpoints de histรณrico
[ ] Criar endpoints de prazos
[ ] Testes de integraรงรฃo
```

### Fase 4: Frontend - Rascunhos
```
[ ] Atualizar pรกgina /admin/atas/importar
[ ] Criar pรกgina /admin/atas/[id]/rascunho
[ ] Criar componente EditorTranscricao
[ ] Criar componente TopicosImportantes
[ ] Criar componente SeletorModelo
[ ] Integrar com API
[ ] Testes E2E
```

### Fase 5: Frontend - Em Processo
```
[ ] Criar pรกgina /admin/atas/[id]/processo
[ ] Criar componente Timeline
[ ] Criar componente ListaPrazos
[ ] Criar componente FormHistorico
[ ] Criar componente FormPrazo
[ ] Criar sistema de notificaรงรตes
[ ] Integrar com API
[ ] Testes E2E
```

### Fase 6: Frontend - Listagem e Filtros
```
[ ] Atualizar /admin/atas com filtros
[ ] Criar abas por status
[ ] Adicionar badges de status
[ ] Adicionar indicadores de prazos
[ ] Criar busca avanรงada
[ ] Testes E2E
```

### Fase 7: Finalizaรงรฃo
```
[ ] Documentaรงรฃo tรฉcnica
[ ] Documentaรงรฃo do usuรกrio
[ ] Testes finais
[ ] Deploy em staging
[ ] Ajustes finais
[ ] Deploy em produรงรฃo
```

---

## ๐ฏ Mรฉtricas de Sucesso

### Performance
- [ ] Extraรงรฃo de PDF < 30 segundos
- [ ] Transcriรงรฃo < 2 minutos
- [ ] Tempo de resposta API < 2 segundos
- [ ] Suporte a PDFs atรฉ 10MB

### Qualidade
- [ ] Taxa de sucesso extraรงรฃo > 95%
- [ ] Taxa de satisfaรงรฃo transcriรงรฃo > 80%
- [ ] Cobertura de testes > 80%
- [ ] Zero bugs crรญticos

### Usabilidade
- [ ] Tempo mรฉdio de criaรงรฃo de rascunho < 5 minutos
- [ ] Taxa de conclusรฃo de fluxo > 90%
- [ ] Satisfaรงรฃo do usuรกrio > 4.5/5

---

**รltima Atualizaรงรฃo:** 2025-01-XX  
**Status:** ๐ Diagramas de Referรชncia

